<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Probiotic Designer</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <!-- Floating bubbles background -->
  <div class="bubbles">
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
  </div>

  <div class="page">
    <header class="header">
      <div class="brand">
        <div class="brand-icon">üß™</div>
        <div class="brand-text">
          <h1>Probiotic Designer</h1>
          <p>Craft your perfect fermented drink</p>
        </div>
      </div>
      <div class="mode-toggle">
        <button class="mode-btn active" data-mode="auto">
          <span class="mode-icon">‚ú®</span> Auto Mode
        </button>
        <button class="mode-btn" data-mode="manual">
          <span class="mode-icon">üßÆ</span> Manual Mode
        </button>
      </div>
    </header>

    <main class="main">
      <!-- Left Panel - Form -->
      <section class="card form-card">
        <!-- Auto mode form -->
        <form id="auto-form" class="mode-form">
          <h2>Auto Recipe Generator</h2>
          <p class="subtitle">Set your preferences and let us create the perfect blend.</p>

          <div class="field-group">
            <div class="slider-field">
              <label for="sweetness">
                Sweetness
                <span class="slider-value" id="sweetness-value">7</span>
              </label>
              <input type="range" id="sweetness" name="sweetness" min="1" max="10" value="7" class="slider">
              <div class="slider-labels">
                <span>Dry</span>
                <span>Sweet</span>
              </div>
            </div>

            <div class="slider-field">
              <label for="tartness">
                Tartness
                <span class="slider-value" id="tartness-value">5</span>
              </label>
              <input type="range" id="tartness" name="tartness" min="1" max="10" value="5" class="slider">
              <div class="slider-labels">
                <span>Mild</span>
                <span>Tangy</span>
              </div>
            </div>
          </div>

          <div class="field-row">
            <div class="field">
              <label for="style">Flavor Style</label>
              <select id="style" name="style">
                <option value="">Any</option>
                <option value="tropical">Tropical</option>
                <option value="berry">Berry</option>
                <option value="citrus">Citrus</option>
                <option value="neutral">Neutral</option>
              </select>
            </div>

            <div class="field">
              <label for="auto-intensity">Juice Intensity</label>
              <select id="auto-intensity" name="intensity">
                <option value="light">Light</option>
                <option value="medium" selected>Medium</option>
                <option value="strong">Strong</option>
              </select>
            </div>
          </div>

          <div class="field">
            <label for="auto-batch_l">Batch Size</label>
            <div class="input-with-unit">
              <input type="number" id="auto-batch_l" name="batch_l" step="0.5" value="3">
              <span class="unit">L</span>
            </div>
          </div>

          <div class="field">
            <label for="auto-juice_ml_per_L">Total Juice per Liter</label>
            <div class="input-with-button">
              <div class="input-with-unit">
                <input type="number" id="auto-juice_ml_per_L" name="juice_ml_per_L" step="5" value="80">
                <span class="unit">ml</span>
              </div>
              <button type="button" id="auto-calc-juice" class="btn-secondary">
                <span class="btn-icon">üßÆ</span> Auto-Calculate
              </button>
            </div>
            <small id="auto-juice-status" class="status-text"></small>
          </div>

          <div class="field">
            <label for="auto-temp_C">Room Temperature</label>
            <div class="input-with-button">
              <div class="input-with-unit">
                <input type="number" id="auto-temp_C" name="temp_C" step="0.5" value="28">
                <span class="unit">¬∞C</span>
              </div>
              <button type="button" id="auto-detect-temp" class="btn-secondary">
                <span class="btn-icon">üìç</span> Auto-Detect
              </button>
            </div>
            <small id="auto-temp-status" class="status-text"></small>
          </div>

          <button type="submit" class="btn-primary">
            <span class="btn-icon">‚ú®</span> Generate Auto Blend
          </button>
        </form>

        <!-- Manual mode form -->
        <form id="manual-form" class="mode-form hidden">
          <h2>Manual Blend Calculator</h2>
          <p class="subtitle">Select your fruits and percentages for precise control.</p>

          <div class="fruits-section">
            <div class="field-header">
              <span>Fruit Selection</span>
              <span class="total-pct">Total: <span id="total-pct">0</span>%</span>
            </div>

            <div class="fruit-row">
              <div class="fruit-number">1</div>
              <select id="fruit1" name="fruit1" class="fruit-select"></select>
              <input type="number" id="pct1" name="pct1" min="0" max="100" value="25" class="pct-input">
              <span class="pct-label">%</span>
            </div>

            <div class="fruit-row">
              <div class="fruit-number">2</div>
              <select id="fruit2" name="fruit2" class="fruit-select"></select>
              <input type="number" id="pct2" name="pct2" min="0" max="100" value="25" class="pct-input">
              <span class="pct-label">%</span>
            </div>

            <div class="fruit-row">
              <div class="fruit-number">3</div>
              <select id="fruit3" name="fruit3" class="fruit-select"></select>
              <input type="number" id="pct3" name="pct3" min="0" max="100" value="25" class="pct-input">
              <span class="pct-label">%</span>
            </div>

            <div class="fruit-row">
              <div class="fruit-number">4</div>
              <select id="fruit4" name="fruit4" class="fruit-select"></select>
              <input type="number" id="pct4" name="pct4" min="0" max="100" value="25" class="pct-input">
              <span class="pct-label">%</span>
            </div>
          </div>

          <div class="field">
            <label for="manual-batch_l">Batch Size</label>
            <div class="input-with-unit">
              <input type="number" id="manual-batch_l" name="batch_l" step="0.5" value="3">
              <span class="unit">L</span>
            </div>
          </div>

          <div class="field">
            <label for="manual-juice_ml_per_L">Total Juice per Liter</label>
            <div class="input-with-button">
              <div class="input-with-unit">
                <input type="number" id="manual-juice_ml_per_L" name="juice_ml_per_L" step="5" value="80">
                <span class="unit">ml</span>
              </div>
              <button type="button" id="manual-calc-juice" class="btn-secondary">
                <span class="btn-icon">üßÆ</span> Auto-Calculate
              </button>
            </div>
            <small id="manual-juice-status" class="status-text"></small>
          </div>

          <div class="field">
            <label for="temp_C">Room Temperature</label>
            <div class="input-with-button">
              <div class="input-with-unit">
                <input type="number" id="temp_C" name="temp_C" step="0.5" value="28">
                <span class="unit">¬∞C</span>
              </div>
              <button type="button" id="manual-detect-temp" class="btn-secondary">
                <span class="btn-icon">üìç</span> Auto-Detect
              </button>
            </div>
            <small id="manual-temp-status" class="status-text"></small>
          </div>

          <button type="submit" class="btn-primary">
            <span class="btn-icon">üßÆ</span> Calculate Manual Blend
          </button>
        </form>
      </section>

      <!-- Right Panel - Results -->
      <section class="card results-card">
        <h2>Recipe Results</h2>

        <div id="correction-notification" class="notification hidden"></div>

        <div id="blend-output" class="blend-output hidden">
          <div class="results-section">
            <h3 class="section-title">Fruit Blend</h3>
            <div class="fruit-blend-table">
              <table>
                <thead>
                  <tr>
                    <th>Fruit</th>
                    <th>% in Blend</th>
                    <th>ml/L</th>
                    <th>ml for Batch</th>
                  </tr>
                </thead>
                <tbody id="fruits-table-body"></tbody>
              </table>
            </div>
          </div>

          <div class="results-section">
            <h3 class="section-title">
              <span class="section-icon">üß™</span> Complete Formulation
            </h3>
            <div class="formulation-grid">
              <div class="formulation-row">
                <span class="formulation-label">Water</span>
                <span class="formulation-value" id="form-water">--</span>
              </div>
              <div class="formulation-row">
                <span class="formulation-label">Total Fruit Juice Blend</span>
                <span class="formulation-value" id="form-fruit-juice">--</span>
              </div>
              <div class="formulation-breakdown" id="fruit-juice-details">
                <!-- Individual fruit juices will be inserted here -->
              </div>
              <div class="formulation-row">
                <span class="formulation-label">Lemon Juice</span>
                <span class="formulation-value" id="form-lemon">--</span>
              </div>
              <div class="formulation-row">
                <span class="formulation-label">Ginger Bug (Culture)</span>
                <span class="formulation-value" id="form-ginger-bug">--</span>
              </div>
              <div class="formulation-total-row">
                <span class="formulation-label"><strong>Total Batch</strong></span>
                <span class="formulation-value"><strong id="form-total">--</strong></span>
              </div>
            </div>
          </div>

          <div class="results-section fermentation-section">
            <h3 class="section-title">
              <span class="section-icon">‚è±Ô∏è</span> Optimal Fermentation Time
            </h3>
            <div class="fermentation-display">
              <div class="fermentation-main">
                <span class="fermentation-hours" id="ferment-optimal">--</span>
                <span class="fermentation-label">hours</span>
              </div>
              <div class="fermentation-range" id="ferment-range-text">Range: -- to -- hours</div>
            </div>
            <div class="fermentation-quality" id="ferment-recommendation">--</div>
            <div class="fermentation-phases">
              <div class="phase-card">
                <div class="phase-time" id="phase-1-time">--</div>
                <div class="phase-label">Phase 1: Active Fermentation</div>
              </div>
              <div class="phase-card">
                <div class="phase-time" id="phase-2-time">--</div>
                <div class="phase-label">Phase 2: Settling & Carbonation</div>
              </div>
            </div>
          </div>

          <div class="metrics-grid">
            <div class="metric-card">
              <div class="metric-icon">üíß</div>
              <div class="metric-content">
                <div class="metric-label">Total Sugar</div>
                <div class="metric-value">
                  <span id="metric-sugar">--</span>
                  <span class="metric-unit">g/L</span>
                </div>
              </div>
            </div>
            <div class="metric-card">
              <div class="metric-icon">ü´ß</div>
              <div class="metric-content">
                <div class="metric-label">CO‚ÇÇ</div>
                <div class="metric-value">
                  <span id="metric-co2">--</span>
                  <span class="metric-unit">vols</span>
                </div>
              </div>
            </div>
            <div class="metric-card">
              <div class="metric-icon">üç∑</div>
              <div class="metric-content">
                <div class="metric-label">ABV</div>
                <div class="metric-value">
                  <span id="metric-abv">--</span>
                  <span class="metric-unit">% (max)</span>
                </div>
              </div>
            </div>
            <div class="metric-card">
              <div class="metric-icon">üõ°Ô∏è</div>
              <div class="metric-content">
                <div class="metric-label">Safety</div>
                <div class="metric-value">
                  <span id="metric-safety">--</span>
                </div>
              </div>
            </div>
          </div>

          <div class="info-cards">
            <div class="info-card">
              <div class="info-icon">üí∞</div>
              <div class="info-content">
                <div class="info-label">Estimated Cost</div>
                <div class="info-value" id="metric-cost">--</div>
              </div>
            </div>
            <div class="info-card">
              <div class="info-icon">üå°Ô∏è</div>
              <div class="info-content">
                <div class="info-label">Safety Detail</div>
                <div class="info-value" id="metric-safety-detail">--</div>
              </div>
            </div>
          </div>

          <div class="recipe-summary-card">
            <p id="recipe-summary">--</p>
          </div>
        </div>

        <div id="no-results" class="empty-state">
          <div class="empty-icon">üß™</div>
          <div class="sparkle">‚ú®</div>
          <h3>Ready to Create</h3>
          <p>Configure your probiotic drink using the form on the left, then generate your perfect recipe with intelligent calculations.</p>
          <div class="empty-features">
            <span class="feature-dot">‚óè</span> Auto mode for quick recipes
            <span class="feature-dot orange">‚óè</span> Manual mode for precision
          </div>
        </div>
      </section>
    </main>
  </div>

  <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
